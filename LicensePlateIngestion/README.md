# License Plate Ingestion Service

This service provides a serverless API endpoint to receive license plate data and ingest it into an AWS Kinesis Firehose stream for further processing and storage.

## Overview

The License Plate Ingestion Service is built using the Serverless Framework. It exposes an HTTP POST endpoint that accepts JSON data representing a license plate read. This data is then pushed to an AWS Kinesis Firehose delivery stream, which buffers the data and delivers it to an S3 bucket for persistent storage.

## Architecture

The architecture is simple and follows a common serverless pattern:

`HTTP POST Request` -> `API Gateway` -> `AWS Lambda (receivelprdata)` -> `AWS Kinesis Firehose (LicensePlateDataStream)` -> `AWS S3 Bucket`

1.  An external system sends a `POST` request with license plate data in the JSON body to the deployed API Gateway endpoint.
2.  API Gateway triggers the `receivelprdata` Lambda function.
3.  The Lambda function receives the data, formats it, and sends it to the `LicensePlateDataStream` Kinesis Firehose stream.
4.  Kinesis Firehose buffers the incoming data and, based on its configuration (e.g., time or buffer size), writes the data to a specified S3 bucket.

## Project Structure

-   `.serverless/`: This directory is generated by the Serverless Framework during deployment and contains the packaged service.
-   `receive_data_handler.py`: Contains the Python code for the AWS Lambda function that handles the incoming data.
-   `serverless.yml`: The core configuration file for the Serverless Framework. It defines the AWS resources, functions, permissions, and triggers for the service.
-   `README.md`: This file.

## Deployment

To deploy this service, you need the [Serverless Framework](https://www.serverless.com/framework/docs/getting-started) installed and your AWS credentials configured.

1.  Navigate to the `LicensePlateIngestion` directory.
2.  Run the deployment command:
    ```bash
    serverless deploy
    ```

This command will provision all the necessary AWS resources (API Gateway, Lambda, Kinesis Firehose, S3 Bucket, and IAM Roles) as defined in `serverless.yml`.

## Usage

After deployment, the Serverless Framework will output the URL of the HTTP API endpoint. You can send data to this endpoint using a `POST` request.

Here is an example using `curl`:

```bash
curl -X POST \
  'YOUR_API_GATEWAY_ENDPOINT_URL' \
  -H 'Content-Type: application/json' \
  -d '{
    "plate_number": "ABC-1234",
    "timestamp": "2023-10-27T10:00:00Z",
    "camera_id": "cam-01"
  }'
```

Replace `YOUR_API_GATEWAY_ENDPOINT_URL` with the actual endpoint URL from your deployment output.

### Successful Response

If the data is successfully sent to the Firehose stream, the API will return a `200 OK` status code with the following body:

```json
{
  "message": "Data sent to firehose"
}
```

### Error Response

If an error occurs, the API will return a `500 Internal Server Error` with details about the error.